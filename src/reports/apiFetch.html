<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Task</title>
</head>
    <style>
    h3, h4{color: blueviolet; font-size: 1em}
    p{color:black}    
    </style>
<body>

<div>
    <h3 id="agrupacion">Category: Authentication & Authorization</h3>
    <h4 id="apikey">Verify:</h4>
    <input type="text" id="inputSearchElement" placeholder="Ingrese el valor">
    <button id="buscarButton">Buscar</button>
    <div id="resultadoContainer"></div>
</div>
    
    <script>
    document.addEventListener('DOMContentLoaded', function () {
    async function apiFetch() {
    let apiTask = 'https://api.publicapis.org/entries'
    const etiquetaH3 = document.getElementById('agrupacion')
    const etiquetaH4 = document.getElementById('apikey')
    let datos;
    let entries;
    let start = Date.now()
        try {
            const response = await fetch(apiTask, {
                method: 'GET',
            });

            if (!response.ok) {
                throw new Error('Error al obtener datos');
            }
            
            const data = await response.json();
            datos = data
            entries = data.entries

        } catch (error) {
            console.error('Error al obtener datos:', error);
        }
        let end = Date.now()
        let duration = end - start
        console.log('El timpo de request es: ' + duration)  

        const Auth = entries.map(e => e.Auth)
        // Contamos canitdad de valores unicos en la categoria 'Auth'
        const countTypesAuth = [...new Set(Auth)]
        // Contamos cantidad de cada valor encontrado en la categoria 'Auth'
        const countAuth = {}
        Auth.forEach(Auth => {
            countAuth[Auth] = (countAuth[Auth] || 0) + 1
        });
        // Funcion para imprimir los valores agrupados en pantalla
        for(const key in countAuth){
            if(countAuth.hasOwnProperty(key)){
                const value = countAuth[key];
                const paragraph = document.createElement('p');
                paragraph.textContent = `${key}: ${value}`;
                etiquetaH3.appendChild(paragraph)
            }
        }
        // Obtén referencias a los elementos del DOM
        const inputSearchElement = document.getElementById('inputSearchElement');
        const buscarButton = document.getElementById('buscarButton');
        const resultadoContainer = document.getElementById('resultadoContainer');
        // Agrega un evento de clic al botón
        buscarButton.addEventListener('click', function() {
            // Obtiene el valor del input
            const inputElement = inputSearchElement.value;
            // Realiza la búsqueda
            const searchElement = inputElement;
            const verifyElement = Auth.includes(searchElement);
            // Crea y muestra el resultado
            const resultadoSearch = document.createElement('p');
            resultadoSearch.textContent = `¿La categoría "${searchElement}" está presente? ${verifyElement ? 'Sí' : 'No'}`;
            // Limpia el contenedor antes de agregar el nuevo resultado
            resultadoContainer.innerHTML = '';
            resultadoContainer.appendChild(resultadoSearch);
        });

        // console.log('Auth unica en grupo: ', countTypesAuth)
        console.log(countTypesAuth)  

        return datos
        }   

    apiFetch()

    })   
    </script>
</body>
</html>